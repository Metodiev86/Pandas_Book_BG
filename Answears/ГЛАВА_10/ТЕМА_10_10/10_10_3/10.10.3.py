# 3.	Добавяне на данни: Създайте DataFrame и го запишете в HDF5 файл (използвайте format='table'). След това създайте друг DataFrame със същите колони, но с нови данни, и го добавете към съществуващия обект в HDF5 файла. Прочетете целия обект, за да се уверите, че данните са добавени правилно.

import pandas as pd

# --- 1. Създаване на начален DataFrame ---
df1 = pd.DataFrame({
    'Име': ['Анна', 'Боби'],
    'Възраст': [28, 34],
    'Град': ['София', 'Пловдив']
})

# --- 2. Запис в HDF5 файл с формат 'table' ---
df1.to_hdf('people_data.h5', key='хора', mode='w', format='table')
print("Първи запис извършен.")

# --- 3. Създаване на нови данни със същите колони ---
df2 = pd.DataFrame({
    'Име': ['Соня', 'Даниел'],
    'Възраст': [22, 40],
    'Град': ['Варна', 'Русе']
})

# --- 4. Добавяне към съществуващия ключ 'хора' ---
df2.to_hdf('people_data.h5', key='хора', mode='a', format='table', append=True)
print("Добавени са нови редове.")

# --- 5. Прочитане на целия обект от HDF5 файла ---
df_all = pd.read_hdf('people_data.h5', key='хора')
print("\nВсички записани данни:")
print(df_all)



#=============================================Забележки:=====================================================
#
# Колоните и типовете им трябва да съвпадат между df1 и df2.
#
# Ако подадеш различни колони или типове, ще получиш грешка при append=True.
#
# Използвай key='...' внимателно — това е като "името" на таблицата вътре във файла.