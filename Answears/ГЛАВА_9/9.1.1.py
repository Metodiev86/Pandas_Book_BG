# 1.	Групирайте df_employees по колона 'Отдел'.
# а) Изведете всички служители в отдел 'Продажби'.
# б) Намерете средната възраст и средното заплащане за всеки отдел.
# в) Пребройте броя на служителите във всеки отдел.
# г) Намерете служителя с най-високо заплащане във всеки отдел.

import pandas as pd

# Данни
data = {
    'Отдел': ['Продажби', 'Маркетинг', 'Продажби', 'Развитие', 'Маркетинг', 'Развитие', 'Продажби', 'Маркетинг'],
    'Служител': ['Алиса', 'Борис', 'Цветан', 'Диана', 'Елена', 'Георги', 'Иван', 'Жана'],
    'Пол': ['Ж', 'М', 'М', 'Ж', 'Ж', 'М', 'М', 'Ж'],
    'Години': [25, 32, 40, 28, 35, 45, 30, 26],
    'Заплащане': [5000, 6000, 7500, 8000, 6500, 9000, 7000, 5500],
    'Бонус': [500, None, 750, 1000, 650, 1200, 700, None]
}

df_employees = pd.DataFrame(data)

# а) Изведете всички служители в отдел 'Продажби'
sales_employees = df_employees[df_employees['Отдел'] == 'Продажби']
print("а) Служители в отдел 'Продажби':\n", sales_employees)

# б) Средна възраст и заплащане за всеки отдел
mean_age_salary = df_employees.groupby('Отдел')[['Години', 'Заплащане']].mean()
print("\nб) Средна възраст и заплащане по отдел:\n", mean_age_salary)

# в) Брой на служителите във всеки отдел
employee_count = df_employees.groupby('Отдел')['Служител'].count()
print("\nв) Брой служители по отдел:\n", employee_count)

# г) Служител с най-високо заплащане във всеки отдел
# Използваме groupby + idxmax за да вземем индекса на най-високо платения служител във всеки отдел
idx_max_salary = df_employees.groupby('Отдел')['Заплащане'].idxmax()
top_earners = df_employees.loc[idx_max_salary][['Отдел', 'Служител', 'Заплащане']]
print("\nг) Служител с най-високо заплащане по отдел:\n", top_earners)

# Обяснения (в коментари в кода):
# Използваме groupby('Отдел') за да групираме по отдел.
#
# [['Години', 'Заплащане']].mean() изчислява средните стойности само за избраните числови колони.
#
# За най-високо заплащане използваме idxmax() — връща индекса на реда с максимална стойност, което после ни позволява да извлечем пълната информация с .loc[].