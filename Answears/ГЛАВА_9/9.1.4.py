# 4.	Използвайте .transform() за да добавите колона към df_employees, която съдържа средното заплащане за отдела на всеки служител.

import pandas as pd

# Изходни данни
data = {
    'Отдел': ['Продажби', 'Маркетинг', 'Продажби', 'Развитие', 'Маркетинг', 'Развитие', 'Продажби', 'Маркетинг'],
    'Служител': ['Алиса', 'Борис', 'Цветан', 'Диана', 'Елена', 'Георги', 'Иван', 'Жана'],
    'Пол': ['Ж', 'М', 'М', 'Ж', 'Ж', 'М', 'М', 'Ж'],
    'Години': [25, 32, 40, 28, 35, 45, 30, 26],
    'Заплащане': [5000, 6000, 7500, 8000, 6500, 9000, 7000, 5500],
    'Бонус': [500, None, 750, 1000, 650, 1200, 700, None]
}
df_employees = pd.DataFrame(data)

# Използване на .transform() за добавяне на колона със средното заплащане за отдела на всеки служител
df_employees['Средно заплащане в отдел'] = df_employees.groupby('Отдел')['Заплащане'].transform('mean')

# Показваме резултата
print("\nDataFrame с добавена колона за средно заплащане в отдел:\n", df_employees)


# Обяснение:
# .groupby('Отдел') събира данните по колона "Отдел".
#
# .transform('mean') изчислява средното заплащане за всеки отдел, като използва метода .transform(), който запазва структурата на DataFrame-а и добавя съответната стойност към всеки ред.
#
# Резултатът е нова колона 'Средно заплащане в отдел', която съдържа средното заплащане за отделите, но с една стойност за всеки служител от съответния отдел.